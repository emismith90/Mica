// Write your Javascript code.

(function ($) {
    $.fn.getFormData = function () {
        var data = {};
        var dataArray = $(this).serializeArray();
        for (var i = 0; i < dataArray.length; i++) {
            data[dataArray[i].name] = dataArray[i].value;
        }
        return data;
    }
})(jQuery);
(function ($) {
    $.fn.registerAsDeleteModal = function () {
        var $modal = $(this);
        var $form = $('#delete-material', $modal);

        $('.js-delete--material').click(function () {
            if (!$form.valid()) return;

            $.ajax({
                url: '/Material/Delete/',
                data: $form.getFormData(),
                type: 'POST',
                success: function (data) {
                    location.reload();
                }
            });
        });
    }
})(jQuery);
(function ($) {
    $.fn.registerAsEditModal = function () {
        var $modal = $(this);
        var $form = $('#edit-material', $modal);

        $('.js-save--material').click(function () {
            if (!$form.valid()) return;

            $.ajax({
                url: '/Material/Save/',
                data: $form.getFormData(),
                type: 'POST',
                success: function (data) {
                    location.reload();
                }
            });
        });
    }
})(jQuery);
(function ($) {
    $(document).ready(function () {
        $('.js-open-modal').on('click', function () {
            var contentUrl = $(this).data('modal-content-url');
            var target = $(this).data('target');
            var formType = $(this).data('form-type');

            // clear modal content
            $('.modal-content', target).html('');

            $.ajax({
                url: contentUrl,
                type: 'GET',
                success: function (data) {
                    $('.modal-content', target).html(data);
                    
                    registerFormSubmitEvent(formType, target);
                }
            });
        });
    })

    function registerFormSubmitEvent(formType, modalSelector) {
        var $modal = $(modalSelector);
        switch (formType) {
            case 'add':
            case 'edit':
                $modal.registerAsEditModal();
                break;
            case 'delete':
                $modal.registerAsDeleteModal();
                break;
        }
    }
})(jQuery);